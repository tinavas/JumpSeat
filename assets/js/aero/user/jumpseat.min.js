"use strict";var Aero={constants:{PATH:AeroStep.baseUrl,USERNAME:AeroStep.getUsername()},model:{},view:{},host:AeroStep.host,send:function(b,d,e,c){if(!c){c="GET"}if(!d.host){d.host=this.host}if(c=="POST"||c=="PUT"){d=JSON.stringify(d)}b=this.constants.PATH+b;var a={async:false,type:c,data:d,dataType:"json",contentType:"application/json",url:b,success:function(f){if(e){e(f)}},error:function(h,g){var f=b+" says: "+JSON.stringify(h)+" "+JSON.stringify(g);Aero.log(JSON.stringify(f))}};if(c=="GET"){a.dataType="jsonp"}$q.ajax(a)},log:function(b,a){if(!AeroStep.debug){return}if(a){switch(a){case"error":console.log("%c"+b,"background: #ea8181; color: #333");break;case"warn":console.log("%c"+b,"background: #eac481; color: #333");break;case"success":console.log("%c"+b,"background: #8eea81; color: #333");break;case"info":console.log("%c"+b,"background: #81d7ea; color: #333");break}}else{console.log(b)}}};Aero.confirm=function(d){var c;var g={ok:AeroStep.lang.ok,cancel:AeroStep.lang.cancel,title:"",msg:"",confirm:false,onClose:function(){},onConfirm:function(){},onCancel:function(){},onValidate:function(){return true}};$q.extend(g,d);function b(){Aero.tpl.get("modal.html",function(i){var h=_q.template(i);$q("body").append(h({msg:g}));c=$q(".aero-modal").hide();g.height=c.outerHeight();c.css({top:($q(window).height()/2)-(g.height/2),left:($q(window).width()/2)-(c.outerWidth()/2)});$q(".aero-backdrop").fadeTo(200,0.5,function(){c.show();$q(".aero-modal-body").find("input:eq(0)").focus()});f(g.onConfirm)})}function e(){c=$q(".aero-modal");c.animate({top:-(g.height)},300,function(){$q(".aero-backdrop, .aero-modal").fadeTo(200,0).remove()})}function a(){if(g.onValidate()){g.onConfirm();e()}}function f(){$q("body").off("keyup.smw").on("keyup.smw",function(i){var h=i.keyCode||i.which;if(h=="27"){g.onCancel();e()}});$q("body").off("click.amwc").on("click.amwc",".aero-modal-close",function(h){g.onClose();e()});$q("body").off("click.confok").on("click.confok",".aero-btn-ok",function(){a()});$q("body").off("click.confc").on("click.confc",".aero-btn-no",function(){g.onCancel();e()});$q(".aero-modal").off("keypress.confk").on("keypress.confk",function(i){var h=i.keyCode||i.which;if(h=="13"){a();return false}})}b()};$q.fn.scrollParent=function(){var c=/(auto|scroll)/,b=this.css("position"),a=b==="absolute",d=this.parents().filter(function(){var e=$q(this);if(a&&e.css("position")==="static"){return false}return(c).test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return b==="fixed"||!d.length?$q(this[0].ownerDocument||document):d};Aero.pos={isFixed:function(c){var b=$q(c);var a=b.add(b.parents());var d=false;a.each(function(){if($q(this).css("position")==="fixed"){d=true;return false}});return d},isScrollable:function(a){var c=a.scrollParent();var b=c.prop("tagName");if(b&&b!="HTML"&&b!="BODY"&&b!="DOCUMENT"){return c}return false}};Aero.tpl={templates:{},get:function(b,e){var a=this;var d="api/template";var c={name:b,guest:Aero.constants.USERNAME};if(a.templates[b]){if(e){e(a.templates[b])}return}Aero.send(d,c,function(f){var g=JSON.parse(f);Aero.tpl.templates[b]=g.tpl;if(e){e(a.templates[b])}})}};$q.fn.aeroSerialize=function(){var c={};var b=this.serializeArray();$q.each(b,function(){var a=this.name.replace("aero_","");if(c[a]!==undefined){if(!c[a].push){c[a]=[c[this.name]]}c[a].push(this.value||"")}else{c[a]=this.value||""}});return c};(function(c){var b={onChange:function(){}};var a={init:function(f){var e,g,i,h;e=$q(this);i=$q(this).attr("id");h=0;b.onChange=f.onChange;e.hide().data("multi-init",true);g=$q('<div id="aeSelect'+i+'" class="aero-multi-select"><a class="aero-multi-drop"></a><ul style="display:none"></ul></div>');e.after(g);e.find("option").each(function(){if(c(this).val()!=""&&c(this).val()!=Aero.tip._guide.id){var j=c(this).is(":selected")?'checked="true"':"";g.find("ul").append('<li><label><input type="checkbox" '+j+'value="'+this.value+'" />'+this.text+"</label></li>");if(j!=""){h++}}});var d=h>0?h+" Selected":"Select Guides";c("#aeSelect"+i).find(".aero-multi-drop").html(d);a.setEvents(i)},setEvents:function(e){var d="#aeSelect"+e;c("body").on("click",function(){c(d).find("ul").hide()});c(d).find("a.aero-multi-drop").on("click",function(g){var f=c(this).parent().find("ul");if(!f.is(":visible")){c(this).parent().find("ul").show()}else{c(this).parent().find("ul").hide()}g.stopPropagation()}).attr("unselectable","on").css("user-select","none").on("selectstart",false);c(d).find(".aero-multi-select li, .aero-multi-select label").on("click",function(f){f.stopPropagation()});c(d).find("input[type=checkbox]").on("change",function(h){c("#"+e+" option[value="+c(this).val()+"]").attr("selected",c(this).is(":checked"));var g=c(d).find("input:checked").length;var f=g>0?g+" Selected":"Select Guides";c(d).find(".aero-multi-drop").html(f);b.onChange(g);h.stopPropagation()})}};c.fn.multiSelect=function(d){if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments)}else{c.error("Method "+d+" does not exist on jQuery.tooltip")}}}})($q);$q.fn.isFormValid=function(){var a=[];$q(".aero-require-error").removeClass("aero-require-error");$q(".aero-error-box").remove();$q(this).find(".aero-required").each(function(){$q(this).removeClass("aero-require-error");if($q(this).val()==""){if(a.length==0){a.push(AeroStep.lang.requirede)}$q(this).addClass("aero-require-error")}});if(a.length>0){if($q(".aero-modal form:eq(0)").length>0){$q(".aero-modal form:eq(0)").prepend('<div class="aero-error-box"><ul><li>'+a.join("</li><li>")+"</li></ul></div>")}return false}return true};$q.fn.visible=function(k,l){var d=l?l:$q(window);var g=this.length>1?this.eq(0):this,n=g.get(0),f=d.width(),m=d.height();if(typeof n.getBoundingClientRect==="function"){var e=n.getBoundingClientRect(),i=e.top>=0&&e.top<m,c=e.bottom>0&&e.bottom<=m,j=e.left>=0&&e.left<f,a=e.right>0&&e.right<=f,h=k?i||c:i&&c,b=k?j||a:j&&a;return h&&b}};(function(b){var a=b.fn.on,c;b.fn.on=function(){var e=Array.apply(null,arguments);var g=e[e.length-1];if(isNaN(g)||(g===1&&e.pop())){return a.apply(this,e)}var d=e.pop();var f=e.pop();e.push(function(){var h=this,i=arguments;clearTimeout(c);c=setTimeout(function(){f.apply(h,i)},d)});return a.apply(this,e)}}(this.$q));if(!Object.keys){Object.keys=function(c){var b=[];for(var a in c){if(c.hasOwnProperty(a)){b.push(a)}}return b}}if(typeof aerofire!=="undefined"){aerofire.init()};"use strict";Aero.model.audit={key:"aero:session:audit",defaults:function(){return{user:Aero.constants.USERNAME,guideid:Aero.tip._guide.id,pathwayid:Aero.pathway.pathwayid,progress:0,perc:0,timeStart:"",timeStamp:this.getTime(),timeTotal:""}},get:function(){return JSON.parse(aeroStorage.getItem(this.key))},update:function(b){if(AeroStep.admin||!Aero.tip._guide){return}var a=JSON.parse(aeroStorage.getItem(this.key));if(a&&a.id!=""&&b.id==""){b.id=a.id}b.timeStamp=this.getTime();aeroStorage.setItem(this.key,JSON.stringify(b))},getTime:function(){var a=new Date();return a.getFullYear()+"-"+this.padZero(a.getMonth()+1)+"-"+this.padZero(a.getDate())+" "+this.padZero(a.getHours())+":"+this.padZero(a.getMinutes())+":"+this.padZero(a.getSeconds())},padZero:function(a){return("0"+a).slice(-2)}};Aero.view.audit={timeStart:0,timeTotal:0,setEvents:function(){var a=this;a.startTimer();$q(window).on("beforeunload",function(){Aero.audit.save()});$q(window).on("focus.aerof",function(){Aero.view.audit.startTimer()}).on("blur.aerob",function(){Aero.view.audit.stopTimer()})},removeEvents:function(){$q(window).off("blur.aerob focus.aerof")},startTimer:function(){this.timeStart=new Date().getTime()},stopTimer:function(){var a=new Date().getTime();this.timeTotal=(a-this.timeStart)+this.timeTotal}};Aero.audit={enabled:true,url:"api/audit",id:"",furthestStep:0,init:function(b){var a=true;Aero.audit.furthestStep=0;Aero.view.audit.timeTotal=0;if(AeroStep.admin||!Aero.constants.USERNAME||typeof Aero.tip._guide==="undefined"||!Aero.tip._guide||aeroStorage.getItem("aero:session:audit")){a=false}Aero.view.audit.setEvents();if(a){this.create(b)}else{b()}},create:function(c){if(AeroStep.admin){return}var a=this;var b=Aero.model.audit.defaults();b.timeStart=b.timeStamp;b.timeTotal=Aero.view.audit.timeTotal;Aero.send(this.url+"/create",{data:JSON.stringify(b)},function(d){a.id=d;b.id=d;Aero.model.audit.update(b);if(c){c()}},"GET")},update:function(){if(AeroStep.admin){return}var a=Aero.model.audit.get();var b=Aero.tip._current;if(b<this.furthestStep){return}else{this.furthestStep=b}a.progress=(b+1);a.perc=Math.round(((b+1)/Aero.tip._guide.step.length)*100);a.id=this.id;a.timeTotal=Aero.view.audit.timeTotal;Aero.model.audit.update(a)},save:function(b){if(AeroStep.admin||!Aero.tip._guide){return}var a=Aero.model.audit.get();if(a){Aero.view.audit.stopTimer();a.timeTotal=Aero.view.audit.timeTotal;Aero.view.audit.removeEvents();Aero.send(this.url+"/create",{data:JSON.stringify(a)},function(c){Aero.model.audit.update(a)},"GET")}if(b){b()}}};"use strict";Aero.model.pathway={url:"api/pathway"};Aero.view.pathway={render:function(a,b){$q(".aero-here").remove();$q(".ae-here").removeClass("ae-here");try{var d=a[b].title;var e=a[b].id;if(b==0){Aero.guide.getAll(function(f){Aero.view.guide.render(f)})}else{if(b==a.length-1){Aero.onpage.getGuides(function(f){f[0].path="On This Page";Aero.view.guide.render(f)})}else{Aero.pathway.getGuides(e,function(f){f[0].path=d;f[0].pathid=e;Aero.view.guide.render(f)})}}aeroStorage.setItem("aero:pathway",b);aeroStorage.setItem("aero:pathway:name",d);return true}catch(c){return false}},setEvents:function(){var a=this;$q("body").off("click.aeropath").on("click.aeropath",'.aero-carousel a:not(".aero-share")',function(){var b=$q(this).hasClass("aero-left");Aero.pathway.get(function(f){var g=null;var c=aeroStorage.getItem("aero:pathway");var e=f.length-1;var d=c?c:0;if(b){d--}else{d++}if(d<0){d=e}if(d>e){d=0}a.render(f,d)});return false})}};Aero.pathway={init:function(){Aero.view.pathway.setEvents()},get:function(c,b){if(Aero.constants.PATHWAYS){c(Aero.constants.PATHWAYS);return}var a={};a.dropEmpty=true;a.count=true;a.select=["title"];if(b){a={id:b}}Aero.send(Aero.model.pathway.url,a,function(d){if(!d){d=[]}d.unshift({title:AeroStep.lang.allguides});d.push({title:"On This Page"});Aero.constants.PATHWAYS=d;if(c){c(d)}},"GET")},getGuides:function(a,b){if(!Aero.constants.pathway){Aero.constants.pathway={}}if(Aero.constants.pathway&&Aero.constants.pathway[a]){b(Aero.constants.pathway[a]);return}Aero.send("api/pathwaymap/by_pathway",{active:true,pathwayid:a},function(c){Aero.constants.pathway[a]=c;if(b){b(c)}},"GET")}};Aero.onpage={getGuides:function(d){var c=this;var a=[];var b=d;Aero.guide.getAll(function(f){for(var e in f){var g=f[e].step[0];if(g){if(g.position&&g.position=="orphan"){g=f[e].step[1]}if(g.loc=="body"){break}if(g.noUrl=="all"||g.url==AeroStep.getSubURL(window.location.pathname)){a.push(f[e])}}}if(d){d(a)}c.render(a)})},render:function(d){$q(".aero-here").remove();$q(".ae-here").removeClass("ae-here");var g=0;for(var b in d){if(d[b]){var f,a,h,c;f=d[b].step[0];if(f.position&&f.position=="orphan"){f=d[b].step[1]}a=$q(f.loc);h=a.offset();if(h&&a&&!a.hasClass("ae-here")){a.addClass("ae-here").data("ae-id",g);c=$q('<a id="ae-id-'+g+'" class="aero-here">X</a>');try{c.css({top:h.top-20,left:h.left-37}).data("guideids",d[b].id)}catch(e){Aero.log("Failed On Page:"+e,"error")}$q("body").append(c);g++}this.setEvents()}}},setEvents:function(){$q(".aero-here").off("click.aeop").on("click.aeop",function(){Aero.tip.start($q(this).data("guideids"));$q(".aero-here").remove()})}};"use strict";Aero.view.quiz={tpl:function(a){return'<li class="clearfix"><label><input data-ans="'+a.correct+'" type="checkbox" value="1"/>'+a.title+"</label></li>"},render:function(d,c){c=c?c:"";var b='<div class="aero-quiz aero-quiz-'+c+'"><ul class="clearfix">';for(var a in d){if(!$q.isFunction(d[a])){b+=this.tpl(d[a])}}b+="</ul></div>";return b},renderNotification:function(a,c,b){var d="";switch(b){case"err":d='<i class="fa fa fa-warning"></i>Incorrect Answer!';if(c&&c!=""){d+="<div>"+c+"</div>"}break;case"warn":d='<i class="fa fa fa-warning"></i>Please select an answer!';break;case"success":d='<i class="fa fa-check-square-o"></i> Correct!';break}$q(".aero-msg").remove();a.find(".aero-tip-body").prepend('<div class="aero-msg aero-'+b+'">'+d+"</div>")},validate:function(c){var b=true;var a=0;$q("#"+c.id).find("input").each(function(){if($q(this).is(":checked")){a=a+1}if($q(this).data("ans")!=$q(this).is(":checked")){b=false}});if(a==0){this.renderNotification($q("#"+c.id),null,"warn")}else{if(!b){this.renderNotification($q("#"+c.id),c.errmsg,"err")}else{this.renderNotification($q("#"+c.id),null,"success")}}return b}};"use strict";Aero.view.media={tpl:function(d,e){var c=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/;var b=d.match(c);var a=e?(e*0.6)+"px":"100%";if(b&&b[2].length==11){return'<iframe width="100%" height="'+a+'" src="//www.youtube.com/embed/'+b[2]+'" frameborder="0" allowfullscreen></iframe>'}else{return"error"}},render:function(a){if(a.youtube){return this.tpl(a.youtube,a.size)}else{if(a.embed){return a.embed}}}};"use strict";(function(e){var d=(e.browser.msie?"paste":"input")+".mask",f=window.orientation!=undefined;e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},e.fn.extend({caret:function(h,g){if(this.length!=0){if(typeof h=="number"){g=typeof g=="number"?g:h;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(h,g)}else{if(this.createTextRange){var a=this.createTextRange();a.collapse(!0),a.moveEnd("character",g),a.moveStart("character",h),a.select()}}})}if(this[0].setSelectionRange){h=this[0].selectionStart,g=this[0].selectionEnd}else{if(document.selection&&document.selection.createRange){var i=document.selection.createRange();h=0-i.duplicate().moveStart("character",-100000),g=h+i.text.length}}return{begin:h,end:g}}},unmask:function(){return this.trigger("unmask")},mask:function(p,o){if(!p&&this.length>0){var n=e(this[0]);return n.data(e.mask.dataName)()}o=e.extend({placeholder:"_",completed:null},o);var m=e.mask.definitions,l=[],c=p.length,b=null,a=p.length;e.each(p.split(""),function(h,g){g=="?"?(a--,c=h):m[g]?(l.push(new RegExp(m[g])),b==null&&(b=l.length-1)):l.push(null)});return this.trigger("unmask").each(function(){function z(s){var r=y.val(),v=-1;for(var u=0,t=0;u<a;u++){if(l[u]){x[u]=o.placeholder;while(t++<r.length){var q=r.charAt(t-1);if(l[u].test(q)){x[u]=q,v=u;break}}if(t>r.length){break}}else{x[u]==r.charAt(t)&&u!=c&&(t++,v=u)}}if(!s&&v+1<c){y.val(""),B(0,a)}else{if(s||v+1>=c){A(),s||y.val(y.val().substring(0,v+1))}}return c?u:b}function A(){return y.val(x.join("")).val()}function B(r,q){for(var s=r;s<q&&s<a;s++){l[s]&&(x[s]=o.placeholder)}}function C(r){var q=r.which,v=y.caret();if(r.ctrlKey||r.altKey||r.metaKey||q<32){return !0}if(q){v.end-v.begin!=0&&(B(v.begin,v.end),i(v.begin,v.end-1));var u=k(v.begin-1);if(u<a){var t=String.fromCharCode(q);if(l[u].test(t)){h(u),x[u]=t,A();var s=k(u);y.caret(s),o.completed&&s>=a&&o.completed.call(y)}}return !1}}function g(r){var q=r.which;if(q==8||q==46||f&&q==127){var u=y.caret(),t=u.begin,s=u.end;s-t==0&&(t=q!=46?j(t):s=k(t-1),s=q==46?k(s):s),B(t,s),i(t,s-1);return !1}if(q==27){y.val(w),y.caret(0,z());return !1}}function h(r){for(var q=r,u=o.placeholder;q<a;q++){if(l[q]){var t=k(q),s=x[q];x[q]=u;if(t<a&&l[t].test(s)){u=s}else{break}}}}function i(r,q){if(!(r<0)){for(var t=r,s=k(q);t<a;t++){if(l[t]){if(s<a&&l[t].test(x[s])){x[t]=x[s],x[s]=o.placeholder}else{break}s=k(s)}}A(),y.caret(Math.max(b,r))}}function j(q){while(--q>=0&&!l[q]){}return q}function k(q){while(++q<=a&&!l[q]){}return q}var y=e(this),x=e.map(p.split(""),function(r,q){if(r!="?"){return m[r]?o.placeholder:r}}),w=y.val();y.data(e.mask.dataName,function(){return e.map(x,function(r,q){return l[q]&&r!=o.placeholder?r:null}).join("")}),y.attr("readonly")||y.one("unmask",function(){y.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){w=y.val();var q=z();A();var r=function(){q==p.length?y.caret(0,q):y.caret(q)};(e.browser.msie?r:function(){setTimeout(r,0)})()}).bind("blur.mask",function(){z(),y.val()!=w&&y.change()}).bind("keydown.mask",g).bind("keypress.mask",C).bind(d,function(){setTimeout(function(){y.caret(z(!0))},0)}),z()})}})})($q);Aero.model.step={url:"api/steps",defaults:function(a){var b=a+1;if(Aero.tip._guide.step){b=(a===Aero.tip._guide.step.length-1)?-1:a+1}return{loc:"",tries:3,position:"bottom",id:"astep-"+a,next:b,prev:a-1}},update:function(a){aeroStorage.getItem("aero:session:index",function(c){var b=JSON.parse(aeroStorage.getItem("aero:guides"));c=parseInt(c);b[c]=a;aeroStorage.setItem("aero:guides",JSON.stringify(b),function(){});aeroStorage.setItem("aero:session",JSON.stringify(b[c]),function(){Aero.tip.setGuide(a.id,function(){if(Aero.tip._current==Aero.tip._guide.step.length){Aero.tip._current--}if(!Aero.tip._current){Aero.tip._current=0}Aero.tip.jumpTo(Aero.tip._current)})},true)},true)},validate:function(){var b=$q("form").isFormValid();if($q("#aeroEditor").trumbowyg("html").replace(/<br>/g,"")==""){b=false;$q(".trumbowyg-editor").addClass("aero-require-error")}if(!b){$q("#aeroSection0 p:first").after('<div class="aero-error-box">'+AeroStep.lang.requirede+"</div>");var a=$q(".aero-require-error:eq(0)").parents(".aero-tab-content:eq(0)");if(a){a.parent().find('a[href="#'+a.attr("id")+'"]').click()}}return b}};Aero.view.step={render:function(a){var b=this;Aero.tpl.get("sidebar-steps.html",function(c){aeroStorage.getItem("aero:sidebar:open",function(d){aeroStorage.getItem("aero:session:tab",function(f){$q("#aeroStepbar").remove();var e=_q.template(c);$q("body").append(e({sidebar:d,g:a}));$q("#aeroGuidebar").remove();if(f>$q("#aeroStepbar").outerHeight()){f=$q("#aeroStepbar").outerHeight()-100}if(f<0){f=0}$q("#aero-tab").css("top",f+"px");b.setEvents();Aero.view.sidebar.setScrollable()},true)},true)});Aero.view.sidebar.setEvents()},renderShare:function(a){$q("body").append('<div class="aero-share-tip"><span></span><input type="text" value="'+a+'" /></div>');$q(".aero-share-tip input").select()},setState:function(c,e){if(!c){c=Aero.tip._current}if(e){$q(".aero-steps li:eq("+c+")").attr("class","clearfix aero-"+e)}else{var g=$q(".aero-steps li:eq("+c+")");g.addClass("aero-active");g.removeClass("aero-forward aero-missing");aeroStorage.removeItem("aero:session:forward",function(){},true)}var d=$q("div.aero-steps");var b=$q("li.aero-active");var a=$q("div.aero-add-step");var f=0;if(b.length>0){if(a.length>0){f+=a.outerHeight()}d.animate({scrollTop:d.scrollTop()+b.position().top-d.height()/2+b.height()/2-f-$q(".aero-guide-title").outerHeight()})}},setEvents:function(){var a=this;if(AeroStep.admin){$q("body").off("click.sa").on("click.sa",".aero-steps li > a",function(){Aero.tip.jumpTo($q(".aero-steps li").index($q(this).parent()))})}$q("body").off("click.aplay").on("click.aplay","a.aero-play-icon",function(){Aero.view.step.setState(parseInt(aeroStorage.getItem("aero:session:pause")),"non");aeroStorage.removeItem("aero:session:pause");Aero.tip.jumpTo(Aero.tip._current);$q(this).remove()});$q("body").off("click.sas").on("click.sas","a.aero-stop",function(){Aero.tip.stop()});$q("body").off("click.ashare").on("click.ashare","a.aero-share",function(){a.renderShare(Aero.host+$q(this).data("link"));return false});$q(document).click(function(b){if($q(b.target).hasClass("aero-share-tip")||$q(b.target).parent().hasClass("aero-share-tip")){return}$q(".aero-share-tip").remove()});$q("#aero-tab").draggable({axis:"y",distance:10,containment:"body",stop:function(b,c){aeroStorage.setItem("aero:session:tab",c.offset.top,function(){},true)}});if(AeroStep.admin){setTimeout("if(Aero.view.step.admin) Aero.view.step.admin.renderSortable();",100)}}};Aero.step={get:function(b){try{var a=new Aero.model.step.defaults(b);return $q.extend({},a,Aero.tip._guide.step[b])}catch(c){AeroStep.session.destroy();location.reload(true)}},add:function(a,b){a.id=Aero.tip._guide.id;a.insertAt=Aero.tip._current?Aero.tip._current:0;Aero.send(Aero.model.step.url,a,function(c){if(Aero.tip._guide.step.length!=0){Aero.tip._current++}Aero.model.step.update(c);if(b){b(c)}},"POST")},update:function(a,b,c){b.id=Aero.tip._guide.id;b.index=a;Aero.send(Aero.model.step.url,b,function(d){Aero.model.step.update(d);if(c){c(d)}},"PUT")},moveIndex:function(b,a){Aero.send(Aero.model.step.url+"/move",{id:Aero.tip._guide.id,from:b,to:a},function(c){Aero.model.step.update(c)},"PUT")},destroy:function(a,b){Aero.send(Aero.model.step.url,{id:Aero.tip._guide.id,index:a},function(c){Aero.model.step.update(c);if(b){b(c)}},"DELETE")}};"use strict";Aero.tip={tries:0,options:{labels:{end:AeroStep.lang.finished,next:AeroStep.lang.next,prev:AeroStep.lang.prev},template:function(f){var n="",m="",b="",e="";var k=f.position?f.position:"top";var c=parseInt(Aero.tip._current)+1;var l=(Aero.tip._guide)?Aero.tip._guide.step.length:0;if(isNaN(f.size)){n=(f.size&&f.size!="")?" aero-tip-"+f.size:""}else{n="' style='width:"+f.size+"px'"}var h=["OVERVIEW","CLICK","CHOOSE","COPY","DRAG","FORK","NOTE","TIP","TYPE","SCROLL"];var d='<img class="as-icon-TITLE" src="'+Aero.constants.PATH+'assets/images/icons/TITLE.png" title="TITLE" />';for(var g in h){if(typeof h[g]=="string"){var m=(h[g]=="OVERVIEW")?"Overview":"";f.title=f.title.replace(h[g],d.replace(/TITLE/g,h[g].toLowerCase())+" "+m)}}if(f.showTitle){m='<div class="aero-tip-title">'+f.title+"<span></span></div>"}var a=f.multi?"":"<div class='aero-tip-nav clearfix'><div class='aero-progress'><span>Step "+c+" of "+l+"</span></div></div>";if(!Aero.tip._guide){a=""}if(f.answers&&f.answers.length>0){b=Aero.view.quiz.render(f.answers,f.quizsize)}if(f.embed||f.youtube){e=Aero.view.media.render(f)}return"<div id='"+f.id+"' class='aero-tip aero-tip-"+k+n+"' style='display:none'><div class='aero-tip-arrow'></div><div class='aero-tip-body'>"+m+f.body+b+e+"</div>"+a+"<div class='aero-tip-draggable'></div></div>"}},spotlight:function(g,e){return;var b,d,f,a,c;b=$q(e.loc);b.addClass("ae-showElement ae-relativePosition");f=b.outerWidth()+10;a=b.outerHeight()+10;c=b.offset();d=$q('<div class="aero-remove ae-overlay" style="top: 0;bottom: 0; left: 0;right: 0;position: fixed;opacity: 0.8;"></div>');$q("body").append(d);d=$q("<div />").addClass("aero-remove ae-helperLayer").css({width:f,height:a,top:c.top-5,left:c.left-5});$q("body").append(d)},setGuide:function(d,c,b){var a=this;a._guide=false;aeroStorage.getItem("aero:session",function(e){if(e&&!b){a._guide=JSON.parse(e);Aero.view.step.render(a._guide);if(c){c()}}else{Aero.model.guide.byId(d,function(f){a._guide=f;Aero.view.step.render(a._guide);aeroStorage.setItem("aero:session",JSON.stringify(a._guide),function(){if(c){c()}},true)})}},true)},setStep:function(a,b,c){this._current=parseInt(a);if(!b){aeroStorage.setItem("aero:session:current",this._current,function(){if(c){c()}},true)}else{if(c){c()}}},redirect:function(a,k,l){var n=this;var d=false;var e=/#$/;var c=/\/$/;var j=document.URL;var h=false;var b=(h||aeroStorage.override)?Aero.host:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");var g=l?l:b;if(a=="/#/"){d=true}if(!a){a=""}a=g+a;if(!d){if(e.test(j)){j=j.replace("#","")}if(c.test(j)){j=j.slice(0,-1)}}a=AeroStep.getSubURL(a);if(k=="all"){return false}if(k=="par"){j=j.split("?")[0];a=a.split("?")[0]}if(k=="anc"){j=j.split("#")[0];a=a.split("#")[0]}if(j!=a){var f=aeroStorage.getItem("aero:session:404");var m=(f)?(parseInt(f)+1):0;aeroStorage.setItem("aero:session:404",m);if(m>1){Aero.confirm({ok:AeroStep.lang.done,title:AeroStep.lang.notfound,msg:AeroStep.lang.urlloop+"</br></br><strong>"+a+"</strong>",onConfirm:function(){Aero.tip.stop()},onClose:function(){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward")}})}else{if(Aero.forceTakeme||Aero.navigating||Aero.tip._current==0){Aero.navigating=false;window.location=a;return true}Aero.confirm({ok:AeroStep.lang.oopst,cancel:AeroStep.lang.oopsm,title:AeroStep.lang.oops,msg:AeroStep.lang.oopsdesc,onConfirm:function(){window.location=a},onCancel:function(){Aero.forceTakeme=true;var o=Aero.tip._current-1;n.setStep(o,false,function(){Aero.tip.jumpTo(o)})},onClose:function(){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward")}})}return true}return false},validate:function(){var b=true;var a=Aero.step.get(this._current);if(a.answers&&a.answers.length>0){b=Aero.view.quiz.validate(a)}return b},start:function(e,c,d){var b=c?c:0;var a=this;window.postMessage({type:"cloudninjas-track-start"},"*");aeroStorage.getItem("aero:session:cds",function(f){if(!f){aeroStorage.setItem("aero:session:cds",Aero.host,function(){},true)}else{Aero.host=f}a._forward=true;a.setGuide(e,function(){Aero.audit.init(function(){a.setNav();$q(".aero-restrict").remove();a.beforeShow(b)})},d)},true)},stop:function(){if(!this.validate()){return}aeroStorage.setItem("aero:cache",0);var a=this.isReturnBranch();if(!a){if(Aero.tip._guide.step&&Aero.tip._current==(Aero.tip._guide.step.length-1)){this.sayCongrats()}else{window.postMessage({type:"cloudninjas-track-incomplete"},"*")}this.setStep(null);this.hide(this._current);clearInterval(this.ob);Aero.tip._guide=null;AeroStep.session.destroy();Aero.guide.init()}},next:function(){if(!this.validate()){return}var a=Aero.step.get(this._current);this._forward=true;clearInterval(this.ob);aeroStorage.removeItem("aero:session:pause");if(a.next!=-1){this.hide(this._current);this.beforeShow(a.next)}},prev:function(){var a=Aero.step.get(this._current);this._forward=false;clearInterval(this.ob);aeroStorage.removeItem("aero:session:pause");if(a.prev!=-1){this.hide(this._current);this.beforeShow(a.prev)}},jumpTo:function(a){var b=Aero.step.get(a);this._forward=true;clearInterval(this.ob);Aero.jump=true;$q(".aero-play-icon").remove();aeroStorage.removeItem("aero:session:pause");if(b){this.hide(this._current);this.beforeShow(a)}},findStep:function(b){var a=false;if(b.position=="orphan"){b.loc="body"}if(b.loc){a=b.isFrame?$q(b.framePath).contents().find(b.loc):$q(b.loc);if(a.length===0||!a.is(":visible")||a.css("visibility")=="hidden"){a=false}}return a},findStepTimeout:function(type,step,time,i){var self=this;if(Aero.hashChange){return}clearTimeout(Aero.timeFindStep);if($q(".aero-modal:visible").length>0){return}if(self.tries<time*2){Aero.timeFindStep=setTimeout(function(){self.hide(i-1);var before=(self._forward)?step.beforeCode:self._guide.step[i].beforeCode;if(before){try{eval(before)}catch(err){Aero.log("Before show code is broken: "+err,"error")}}self.show(i);self.tries++},500)}else{Aero.view.step.setState(i,"missing");var prefix=type=="loss"?"loss":"";if(step[type]=="alert"){alert(prefix+"alert");this.renderException(step[prefix+"alert"],step[prefix+"alertContent"],true)}else{if(step[type]=="back"){Aero.view.step.setState(i,"missing");this.prev()}else{if(step[type]=="skip"){self.show(i+1)}else{if(step[type]=="skipto"){self.jumpTo(step[prefix+"skipto"]);for(var i=Aero.tip._current;i<=step[prefix+"skipto"]-1;i++){Aero.view.step.setState(i,"missing")}}else{if(step[type]=="ignore"){return}else{this.renderException("Step is Missing","To fix this, try:<ul style='font-size:14px'><li>Using a more generic element</li><li>Increase the step wait timer</li><li>Check the previous step navigation:<ul><li>Page changed or refreshed - when steps move between pages</li><li>Next item visible - on the same page, but has an animation or time delay when showing the next step</li></ul></li></ul>",true)}}}}}}},observe:function(b,d,e){var a=this;var c=Aero.step.get(b);if(d){clearInterval(a.obf);a.obf=setInterval(function(){var f=a.findStep(c);Aero.navigating=true;Aero.log("Observing for item visible","info");if(f){Aero.log("Observe found item","success");clearInterval(a.obf);e()}},500)}else{clearInterval(a.ob);a.ob=setInterval(function(){Aero.log("Observing for item not visible","info");var f=a.findStep(c);if(!f){setTimeout(function(){if(Aero.navigating){Aero.navigating=false;clearInterval(a.ob);return}Aero.log("Observe lost item","warn");e();clearInterval(a.ob)},500)}},1000)}},beforeShow:function(i){var self=this;self.tries=1;var step=Aero.step.get(i);self.setStep(i,false,function(){var wait=200;var before=(self._forward)?step.beforeCode:self._guide.step[i].beforeCode;if(step.pause){wait=parseInt(step.pause)*1000}if(before){try{eval(before)}catch(err){Aero.log("Before show code is broken: "+err,"error")}}clearTimeout(Aero.timeBeforeShow);Aero.timeBeforeShow=setTimeout(function(){if(!Aero.hashChange){self.show(i)}},wait)})},show:function(c,f){var e,b,d,a;a=this;clearTimeout(Aero.timeFindStep);if(Aero.tip._guide.step.length==0){return}if(typeof c=="undefined"){c=a._current}if(!Aero.tip._guide||c>Aero.tip._guide.step.length||c<0){return}aeroStorage.setItem("aero:session:forward",true);d=Aero.step.get(c);aeroStorage.setItem("aero:sidebar:open",d.sidebar?0:1,function(){},true);a.setStep(c,f,function(){if(d.sidebar){setTimeout("Aero.view.sidebar.hide();",100)}else{aeroStorage.getItem("aero:sidebar:open",function(k){if(!$q(".aero-sidebar").hasClass("open")&&k=="1"){Aero.view.sidebar.show()}},true)}b=a.findStep(d,c);if(AeroStep.admin&&aeroStorage.getItem("aero:session:pause")&&aeroStorage.getItem("aero:session:forwardUrl")!==document.URL){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward");var g=$q('<a class="aero-play-icon"><span></span></a>');g.css({top:$q(window).height()/2-150,left:$q(window).width()/2-100});$q("body").append(g);return}else{if(a.redirect(d.url,d.noUrl,d.cds)){return}}aeroStorage.removeItem("aero:session:404");if(b&&b.is(":visible")){Aero.log("Found Step "+c,"success");Aero.navigating=false;Aero.tip.isMoving=null;a.observe(c,false,function(){a.findStepTimeout("loss",d,0,c)});if(d.mask&&d.mask!=""){b.mask(d.mask)}Aero.audit.update();if(AeroStep.admin){aeroStorage.setItem("aero:sidebar:cdshost",c+"~"+window.location.host,function(){},true);aeroStorage.setItem("aero:session:pause",c);aeroStorage.setItem("aero:session:forwardUrl",document.URL)}e=$q(a.options.template(d));if(d.branch){e=a.renderBranch(e,d.branch,d.branchstep,d["return"])}e=a.buildNav(e,d);$q(".ae-active-el").removeClass("ae-active-el");b.addClass("ae-active-el");$q("body").append(e);Aero.view.step.setState(c);a.setPosition(b,e,d.position);a.setEvents(b,d.nav,e,d.position);if(d.position!="orphan"){a.scrollToElement(b)}else{$q(".aero-tip").fadeIn(200)}}else{if(d.tries&&d.tries>0){a.findStepTimeout("miss",d,d.tries,c);return}else{if(!d.multi){clearTimeout(Aero.timeFindStep);Aero.log("Skipping step: "+c+" with loc:"+d.loc,"error");Aero.view.step.setState(c,"missing");if(c<Aero.tip._guide.step.length){if(a._forward){a.next()}else{a.prev()}}}}}var h=(a._forward)?1:-1;var j=false;if(a._forward&&Aero.step.get(c+h).multi||!a._forward&&d.multi){j=true}if(Aero.jump&&d.multi){j=true;h=-1;a._forward=false}if(j){a.show(c+h,true)}Aero.jump=null})},hide:function(i){var step=Aero.step.get(i);if(!$q(".aero-tip:visible").length>0){return}$q(".aero-active, .aero-showElement").removeClass("aero-active aero-showElement aero-relativePosition");$q(".aero-tip, .aero-remove").remove();if(step.afterCode){try{eval(step.afterCode)}catch(err){Aero.log("After hide code is broken: "+err,"error")}}},buildNav:function(b,c){var d="";var a=false;if(!c.nav.next&&!c.nav.blur){a=true}if(c.nav.length==0){a=false}if(!c.noNav){if(c.next==-1){d+="<a class='aero-btn-end'>"+this.options.labels.end+"</a>"}if(!c.noNext&&!a&&c.next!=-1){d+="<a class='aero-btn-next'>"+this.options.labels.next+"</a>"}if(!c.noPrev&&c.prev!=-1){d+="<a class='aero-btn-prev'>"+this.options.labels.prev+"</a>"}}b.find(".aero-tip-nav").append(d);return b},setPosition:function(k,b,c){var h={};var a=k.offset();var e=b.outerWidth()/2;var d=b.outerHeight();var j=a.left+(k.outerWidth()/2);var g=a.top+(k.outerHeight()/2);var f=b.find(".aero-tip-arrow");h.tLeft=e-(f.outerWidth()/2);h.tTop=(b.outerHeight()/2)-(f.outerHeight()/2);switch(c){case"top":h.left=j-e;h.top=a.top-d-b.find(".aero-tip-arrow").outerHeight();break;case"bottom":h.left=j-e;h.top=a.top+k.outerHeight();break;case"left":h.left=a.left-b.outerWidth()-b.find(".aero-tip-arrow").outerWidth();h.top=g-(d/2);break;case"right":h.left=a.left+k.outerWidth();h.top=g-(d/2);break;case"orphan":h.left=$q(window).width()/2-e;h.top=$q(window).height()/2-(d/2);break}h=this.containIn(document,b,h,c);b.css({left:h.left,top:h.top});if(b.hasClass("aero-tip-bottom")||b.hasClass("aero-tip-top")){f.css({left:h.tLeft})}if(b.hasClass("aero-tip-left")||b.hasClass("aero-tip-right")){f.css({top:h.tTop})}if(b.hasClass("aero-tip-top")){f.css({top:"auto"})}},containIn:function(b,f,h,g){var d=$q(b).height();var j=$q(window).width();var e=h.left+f.outerWidth()-j;var c=h.top+f.outerHeight()-d;if(e>0){if(g=="bottom"||g=="top"){h.tLeft+=e}h.left-=e}if(h.left<0){if(g=="bottom"||g=="top"){h.tLeft+=h.left}h.left-=h.left}if(h.top<0){if(g=="left"||g=="right"){h.tTop+=h.top}h.top-=h.top}if(c>0&&g=="bottom"){if(g=="left"||g=="right"){h.tTop+=c}h.top-=c}var a=h.left+f.outerWidth();if(a>(j-270)){aeroStorage.getItem("aero:sidebar:open",function(k){Aero.view.sidebar.hide()},true)}else{aeroStorage.getItem("aero:sidebar:open",function(k){if(k=="1"){Aero.view.sidebar.show()}},true);if(g=="orphan"){h.left-=115}}return h},scrollToElement:function(b){var c=$q(".aero-tip:eq(0)");var d=Aero.pos.isScrollable(b);var a=0;c.show();if(!b.visible(false,d)||!c.visible(false)){a=d?d.scrollTop()-d.offset().top:0;d=d?d:$q("body, html");c.hide();d.stop().animate({scrollTop:a+b.offset().top-(d.height()/2+b.height()/2)},500,function(){$q(".aero-tip").fadeIn(200)});c.hide()}else{c.hide();$q(".aero-tip").fadeIn(200)}},isReturnBranch:function(){var b=aeroStorage.getItem("aero:session:branch:returnid");var a=aeroStorage.getItem("aero:session:branch:returnto");if(!b){return false}aeroStorage.removeItem("aero:session:branch:returnid");aeroStorage.removeItem("aero:session:branch:returnto");Aero.confirm({ok:"Return",cancel:"End Guide",title:"Branch complete",msg:"You have completed this branch, we will now move you back to the original guide.",onConfirm:function(){Aero.tip.hide();Aero.tip.start(b,parseInt(a),true)},onCancel:function(){Aero.tip.stop()}});return true},renderBranch:function(f,c,e,d){var a=f.find(".aero-tip-body").html();var b=a+"<div class='aero-branch'></div>";setTimeout(function(){for(i in c){if(typeof c[i]=="string"){Aero.guide.get(c[i],function(g){if($q(".aero-branch").find("#b-"+g.id).length==0){$q(".aero-branch").append("<a id='b-"+g.id+"' data-returnid='"+Aero.tip._guide.id+"' data-returnto='"+d+"' data-guideid='"+g.id+"' class='aero-start'>"+g.title+"</a>")}$q(window).trigger("resize")})}}},250);f.find(".aero-tip-body").html(b);return f},renderException:function(e,a,b){var f="";if(b&&AeroStep.admin){f='<div class="aero-section aero-goto"><label>Go back to step:</label><select id="aero-goto">';for(var c=0;c<Aero.tip._guide.step.length;c++){var d=c==(Aero.tip._current-1)?'selected="selected"':"";f+="<option "+d+'value="'+c+'">'+(c+1)+": "+Aero.tip._guide.step[c].title+"</option>"}f+="</select></div>"}Aero.confirm({ok:"End Guide",cancel:b?"Go Back":"Ok",title:e,msg:a+f,onConfirm:function(){Aero.tip.stop()},onCancel:function(){if(b&&AeroStep.admin){Aero.tip.jumpTo(parseInt($q("#aero-goto").val()))}else{if(b){Aero.tip.prev()}}},onClose:function(){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward")}})},setNav:function(){var a=this;$q("body").off("click.aPe").on("click.aPe",".aero-btn-prev",function(){Aero.navigating=true;a.prev()}).off("click.aEd").on("click.aEd",".aero-btn-end",function(){a.stop()})},sayCongrats:function(){aeroStorage.getItem("aero:session",function(b){var a=JSON.parse(b);if(!AeroStep.admin){try{window.postMessage({type:"cloudninjas-track-completed"},"*")}catch(c){console.log("There was an error sending cloud ninja track completed");console.log(c)}AeroStep.session.destroy()}},true)},setEvents:function(c,f,e,a){var b=this,d=false;$q(document).off("scroll.scw").on("scroll.scw"+Aero.tip._current,function(){b.setPosition(c,e,a)},250);$q('div *:not(".aero-steps")').off("scroll.scd").on("scroll.scd"+Aero.tip._current,function(){b.setPosition(c,e,a)},250);$q(".aero-tip").draggable({handle:"div.aero-tip-draggable"});$q(window).on("resize",function(){b.setPosition(c,e,a);Aero.view.sidebar.setScrollable()},250);aeroStorage.removeItem("aero:session:end");if(parseInt($q(".aero-tip:last").attr("id").replace("astep-",""))==(Aero.tip._guide.step.length-1)){aeroStorage.setItem("aero:session:end",1);d=true}$q("body").off("click.branchc").on("click.branchc",".aero-continue",function(){Aero.tip.next()});$q("body").off("click.branchs").on("click.branchs",".aero-start",function(){aeroStorage.setItem("aero:session:branch:returnid",$q(this).data("returnid"));aeroStorage.setItem("aero:session:branch:returnto",$q(this).data("returnto"));Aero.tip.hide();Aero.tip.start($q(this).data("guideid"),0,true)});$q("body").off("click.aNe").on("click.aNe",".aero-btn-next",function(){Aero.navigating=true;b.next()});for(var g in f){if(f.hasOwnProperty(g)){if(f[g]==-1){f[g]=Aero.tip._current+1}f[g]=parseInt(f[g]);switch(g){case"next":$q("body").off("click.aNe").on("click.aNe",".aero-btn-next",function(){Aero.navigating=true;if(!b.validate()){return}b.jumpTo(f[g])});break;case"click":c.off("click.aeronav").on("click.aeronav",c,function(){c.off("click.aeronav");Aero.navigating=true;if(!b.validate()){return}if(d){if(!AeroStep.admin){b.stop()}return}b.jumpTo(f[g])});break;case"mousedown":c.off("mousedown.aeronav").on("mousedown.aeronav",c,function(){Aero.navigating=true;if(!b.validate()){return}if(d){if(!AeroStep.admin){b.stop()}return}b.jumpTo(f[g])});break;case"hover":c.off("mouseenter.aeronav").on("mouseenter.aeronav",c,function(){Aero.navigating=true;if(!b.validate()){return}setTimeout(function(){b.jumpTo(f[g])},500)});break;case"blur":c.focus();c.off("keydown.aeronav").on("keydown.aeronav",c,function(j){Aero.navigating=true;if(!b.validate()){return}var h=j.keyCode||j.which;if(h==13||h==9){b.jumpTo(f[g])}});c.off("focusout.aeronavb").on("focusout.aeronavb",c,function(h){Aero.navigating=true;if(!b.validate()){return}b.jumpTo(f[g])});break;case"unload":$q(window).off("beforeunload.aeronav").on("beforeunload.aeronav",function(){Aero.navigating=true;b.setStep(f[g])});break;case"observe":b.observe(b._current+1,true,function(){Aero.navigating=true;b.next()});break}}}}};"use strict";Aero.model.guide={url:"api/guides",urlSearch:"api/search",defaults:function(){return{title:"",active:false,steps:[]}},byId:function(b,a){Aero.guide.getAll(function(c){$q.each(c,function(e,d){if(d&&(b==d.id)){a(c[e]);aeroStorage.setItem("aero:session:index",e,function(){},true)}})})},update:function(b,a){Aero.guide.getAll(function(c){Aero.view.guide.render(c);if(b){b(a)}},true)},validate:function(){var a=$q("form").isFormValid();if($q("#aeroEditor").trumbowyg("html").replace(/<br>/g,"")==""){a=false;$q(".trumbowyg-editor").addClass("aero-require-error")}if(!a){$q("#aeroSection0 p:first").after('<div class="aero-error-box">'+AeroStep.lang.requirede+"</div>")}return a}};Aero.view.guide={render:function(c,d,b){var a=this;$q(".aero-restrict, .aero-contextual").remove();if(!b){a.clearSearch()}Aero.tpl.get("sidebar-guides.html",function(e){aeroStorage.getItem("aero:sidebar:open",function(f){aeroStorage.getItem("aero:session:tab",function(h){$q("#aeroGuidebar").remove();var g=_q.template(e);$q("body").append(g({sidebar:f,guides:c}));$q("#aeroStepbar").remove();if(h>$q("#aeroGuidebar").outerHeight()){h=$q("#aeroGuidebar").outerHeight()-100}if(h<0){h=0}$q("#aero-tab").css("top",h+"px");a.setEvents();Aero.view.sidebar.setEvents();Aero.view.sidebar.setScrollable();var i=parseInt($q("body").data("newguides"));if(i>0){Aero.view.sidebar.notify(i)}},true)},true)})},renderContextualTip:function(b,c){function a(f,d){var e=$q(Aero.tip.options.template(f));var g=b+"-"+d;e.attr("id","atip-"+g);e.addClass("aero-action-tip");$q("body").append(e);Aero.tip.setPosition($q("#aaction-"+g),$q("#atip-"+g),f.position);e.show()}Aero.guide.get(b,function(d){a(d.step[c],c)})},renderContextualAction:function(a){var e=this;if(!a.contextual||a.contextual.length==0){return}function d(g,j){var f,h;f=$q(j);if(f.length>0){var i=f.offset();h=$q("<a />").attr("id","aaction-"+a.id+"-"+g).addClass("aero-contextual").css({top:i.top+(f.outerHeight()/2)-8,left:i.left+(f.outerWidth())}).data("loc",j).data("guideid",a.id).data("step",parseInt(g));$q("body").append(h)}}for(var c in a.contextual){if(a.step.length>0){var b=parseInt(a.contextual[c]);if(a.step[b]&&a.step[b].loc){d(b,a.step[b].loc)}}}},renderRestrict:function(a){var d=this;if(a.isComplete||!a.restrict||a.restrict.length==0){return}function c(g,i,e){var f,h;f=$q(i);if(f.length>0){h=$q("<a />").addClass("aero-restrict").css({"background-color":e,cursor:"pointer",opacity:0.5}).data("loc",i).data("guideid",a.id).data("step",parseInt(g));$q("body").append(h);d.positionRestrict(h)}}for(var b in a.restrict){b=parseInt(b.replace("s",""));if(a.step.length>0){c(b,a.step[b].loc,a.step[b].restrictColor)}}},positionRestrict:function(b){var a=$q(b.data("loc"));var c=Aero.pos.isFixed(a)?"fixed":"absolute";b.css({width:a.outerWidth(),height:a.outerHeight(),top:a.offset().top,left:a.offset().left,position:c,"z-index":99999999})},search:function(b){var a=this;$q(".aero-search i").switchClass("fa-search","fa-times",0);$q(".aero-search a").switchClass("aero-search-btn","aero-search-clear",0);Aero.guide.getByTerm(b,function(c){c.search=b;a.render(c,function(){},true)})},clearSearch:function(){if($q(".aero-search-clear").length>0){$q(".aero-search i").switchClass("fa-times","fa-search",0);$q(".aero-search a").switchClass("aero-search-clear","aero-search-btn",0);$q(".aero-search").removeClass("aero-active");$q("input[name=aero_search]").val(AeroStep.lang.search)}},setEvents:function(){var a=this;$q("body").off("click.aeroStart").on("click.aeroStart",".aero-guides ul li > a",function(){var b=$q(this).parents("li:eq(0)").data("guideid");aeroStorage.removeItem("aero:session:pause");Aero.tip.start(b)});$q("body").off("click.apF").on("focus.apF",".aero-sidebar input[name=aero_search]",function(){$q(this).parents("div:eq(0)").addClass("aero-active");if($q(this).val()==AeroStep.lang.search){$q(this).val("")}});$q("body").off("click.apB").on("blur.apB",".aero-sidebar input[name=aero_search]",function(){if($q(this).val()==""){$q(this).parents("div:eq(0)").removeClass("aero-active");$q(this).val(AeroStep.lang.search)}});$q("body").off("click.aS").on("click.aS",".aero-search a.aero-search-btn",function(){a.search($q("input[name=aero_search]").val())});$q("body").off("keypress.asK").on("keypress.asK",".aero-sidebar input[name=aero_search]",function(c){var b=c.keyCode||c.which;if(b==13){a.search($q(this).val())}});$q("body").off("click.asC").on("click.asC",".aero-search-clear",function(){Aero.guide.getAll(function(b){a.render(b)});return false});$q("body").off("click.asr").on("click.asr",".aero-restrict",function(){var b=$q(this);Aero.confirm({ok:AeroStep.lang.ok,title:AeroStep.lang.restrictt,msg:AeroStep.lang.restrictb,onConfirm:function(){Aero.tip.start(b.data("guideid"))}})});$q("body").off("mouseenter.actip").on("mouseenter.actip",".aero-contextual",function(){var d=$q(this);var b=d.data("guideid");var c=d.data("step");$q(".aero-action-tip").remove();setTimeout(function(){a.renderContextualTip(b,c)},250)});$q("body").off("mouseleave.actip").on("mouseleave.actip",".aero-contextual",function(){$q(".aero-action-tip").remove()});$q("body").on("click",'input[name="aero_auto"]',function(){$q(".aero-auto-page").hide();if($q(this).is(":checked")){$q(".aero-auto-page").show()}})}};Aero.guide={init:function(){var b=this;var a=aeroStorage.getItem("aero:session:end");if(a){Aero.tip.sayCongrats()}b.getAll(function(c){aeroStorage.getItem("aero:session",function(f){var e=window.location.hash.indexOf("guideid=")!=-1;if(f){var d=JSON.parse(f);aeroStorage.getItem("aero:session:current",function(j){Aero.tip.start(d.id,parseInt(j))},true)}else{if(e){var h=window.location.hash.split("=").slice(-1)[0];Aero.tip.start(h);window.location.hash=window.location.hash.split("guideid")[0]}else{var g=aeroStorage.getItem("aero:pathway");if(g&&g!="0"){Aero.pathway.get(function(j){var i=Aero.view.pathway.render(j,parseInt(g));if(!i){Aero.view.guide.render(c)}})}else{Aero.view.guide.render(c)}}}},true)})},autoStart:function(a){Aero.view.guide.renderRestrict(a);Aero.view.guide.renderContextualAction(a);if(!a.auto){return}if(!a.isComplete&&!AeroStep.admin&&a.step.length>0){var b=false;if(a.autoPage){b=true}else{if(a.step.length>0&&window.location.pathname==a.step[0].url){b=true}}if(b){Aero.tip.start(a.id)}}},updateCache:function(a){aeroStorage.setItem("aero:guides",JSON.stringify(a))},getAll:function(e,c){var d=null;var a=aeroStorage.getItem("aero:guides");var b=aeroStorage.getItem("aero:cache");if(!b){b=AeroStep.cache}b=parseInt(b);if(b!=AeroStep.cache){d=JSON.parse(a);aeroStorage.removeItem("aero:guides");a=null}if(!a||c){Aero.log("Loading from SS","success");Aero.send(Aero.model.guide.url,{enduser:Aero.constants.USERNAME},function(f){if(d){var g=f.length-d.length;if(g>0){$q("body").data("newguides",g)}}aeroStorage.setItem("aero:cache",AeroStep.cache);aeroStorage.setItem("aero:guides",JSON.stringify(f));if(e){e(f)}})}else{Aero.log("Loading from LS","success");e(JSON.parse(a))}},get:function(b,a){Aero.send(Aero.model.guide.url,{id:b},function(c){if(a){a(c)}})},getByTerm:function(a,b){Aero.send(Aero.model.guide.urlSearch,{term:a},function(c){if(b){b(c)}})},create:function(a,b){Aero.send(Aero.model.guide.url,a,function(c){Aero.model.guide.update(b,c)},"POST")},update:function(a,b){Aero.send(Aero.model.guide.url,a,function(){Aero.model.guide.update();if(b){b()}},"PUT")},destroy:function(a){Aero.send(Aero.model.guide.url,{id:a},function(){Aero.model.guide.update()},"DELETE")}};Aero.view.sidebar={setScrollable:function(){var c=$q(window).height()-($q(".aero-head").outerHeight()+$q(".aero-foot").outerHeight());var d=$q(".aero-guide-title").outerHeight();var b=$q(".aero-add-step").length>0?$q(".aero-add-step").outerHeight():0;$q(".aero-guides, .aero-steps").height(c-(d+b))},show:function(a,b){if(!b){b-750}$q(".aero-sidebar").stop().animate({right:"-50px"},b,"easeInOutBack",function(){}).addClass("open");if(a){aeroStorage.setItem("aero:sidebar:open",1,function(){},true)}},hide:function(a){$q(".aero-sidebar").stop().animate({right:-($q(".aero-sidebar").outerWidth(true))},300,"swing",function(){}).removeClass("open");if($q(".aero-admin-wrapper").length){$q(".aero-admin-wrapper").remove();$q("#aero-tab").css("left","-44px")}$q(".aero-blanket, .aero-edit-active").remove();if(a){aeroStorage.setItem("aero:sidebar:open",0,function(){},true)}},notify:function(){$q("#aero-tab").prepend('<span class="aero-not">'+$q("body").data("newguides")+"</span>")},setEvents:function(){var b=this;var a;window.onresize=function(){clearTimeout(a);a=setTimeout(function(){b.setScrollable();var c=$q(".aero-restrict");if(c.length==0){return}c.each(function(){Aero.view.guide.positionRestrict($q(this))})},100)};$q("body").off("click.atc").on("click.atc","#aero-tab a",function(){if($q(".aero-sidebar").hasClass("open")){b.hide(true)}else{b.show(true)}});$q("#aero-tab").draggable({axis:"y",distance:10,containment:"body",stop:function(c,d){aeroStorage.setItem("aero:session:tab",d.offset.top,function(){},true)}});$q(window).off("hashchange.hashn").on("hashchange.hashn",function(){Aero.hashChange=true;AeroStep.ready(function(){setTimeout(function(){Aero.hashChange=false;Aero.guide.init()},500)},AeroStep.required)})}};"use strict";function AeroMain(){$q(function(){aeroStorage.getItem("aero:sidebar:cdshost",function(b){if(b){var a=b.split("~");if(a[1]!=window.location.host){aeroStorage.setItem("aero:session:pause",a[0])}}Aero.guide.init()},true)});Aero.pathway.init()}AeroMain();