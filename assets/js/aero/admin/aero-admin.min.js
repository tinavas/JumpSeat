"use strict";Aero.view.admin={guideid:"",type:"",render:function(b,a){$q(".container-close").remove();this.type=b;if(Aero.tip._guide){Aero.tip.hide()}$q(".aero-active").removeClass("aero-active");Aero.tpl.get("sidebar-"+this.type+"-admin.html",function(e){$q(".aero-admin-wrapper").remove();var d=_q.template(e);$q("body").append(d({model:a}));$q("#aero-tab").css("left","-542px");$q(".aero-sidebar").prepend('<div class="aero-blanket" style="display:none"></div>');$q(".aero-blanket").fadeTo(300,0.9,function(){});if(b=="step"){$q(".aero-nav-item:not(:first)").append('<a class="aero-del-nav">X</a>')}var c=$q.trumbowyg.btnsGrps;$q("#aeroEditor").trumbowyg({fullscreenable:false,fixedFullWidth:true,resetCss:true,autogrow:true,btns:["viewHTML","|",c.design,"|","link","|","insertImage","|",c.justify,"|",c.lists,"|","insertHorizontalRule"]})});setTimeout("$q('.aero-required:eq(0)').focus();",300)},renderMenu:function(c){var b=$q(".aero-strip-menu li").index(c);$q(".aero-admin-body .open").removeClass("open");$q(".aero-strip-menu li").removeClass("aero-menu-active");c.addClass("aero-menu-active");$q("#aeroSection"+b).addClass("open");if(b==2&&this.type=="guide"){Aero.view.guide.admin.renderRoles()}if(b==1&&this.type=="guide"){Aero.view.guide.admin.renderPathways()}if(b==4&&this.type=="step"){var a=$q($q("input[name='aero_loc']").val()).prop("tagName");if(a!="INPUT"){$q('input[name="aero_mask"]').attr("disabled",true).addClass("aero-disabled")}}},renderMenuTip:function(a,d){var c=$q('<div class="aero-menu-tip" style="top:-200px"><span></span>'+d+"</div>");var b=a.offset().top+(c.outerHeight()/2)+16;$q(".aero-app").append(c);c.css({top:b-$q(window).scrollTop(),left:55,opacity:0});c.animate({opacity:1,left:"+=8"},100)},close:function(){var a=($q(".aero-editing-step").hasClass("aero-add-step")?false:true);$q(".aero-admin-wrapper, .aero-edit-active").remove();$q("#aero-tab").css("left","-44px");$q(".aero-blanket").fadeTo("medium",0,function(){$q(this).remove()});$q(".aero-editing").removeClass("aero-editing");if(Aero.tip._guide&&a){var b=Aero.step.get(Aero.tip._current);Aero.tip.beforeShow(Aero.tip._current,b)}},edit:function(c){var a=this;var d=c.parents("li:eq(0)");var b=Aero.tip._guide?"step":"guide";a.guideid=Aero.tip._guide?Aero.tip._guide.id:c.parents("li:eq(0)").data("guideid");d.addClass("aero-editing");d.prepend('<span class="aero-edit-active"></span>');Aero.guide.get(a.guideid,function(e){if(b=="step"){e=e.step[Aero.index];e.id=a.guideid;e.index=Aero.index;e.isAdd=false}Aero.view.admin.render(b,e)})},renderTools:function(b){var d=b.find(".aero-item-tools:eq(0)");if(d.length>0){d.show();return}var c=b.data("guideid")?"guide":"step";var a=b.data("guideid")||Aero.tip._guide.id;Aero.tpl.get("sidebar-"+c+"-tools.html",function(e){Aero.model.guide.byId(a,function(f){var g=_q.template(e);b.prepend(g({creator:(f.creator==Aero.constants.USERNAME)}))})})},setEvents:function(b){var a=this;if(b){a.type=b}$q("body").off("click.aeroCancel").on("click.aeroCancel",".aero-cancel-edit",function(){a.close();return false}).off("mouseenter.aerome").on("mouseenter.aerome",".aero-strip-menu a",function(){$q(".aero-menu-tip").remove();Aero.view.admin.renderMenuTip($q(this),$q(this).data("title"))}).off("mouseleave.aeroml").on("mouseleave.aeroml",".aero-strip-menu a",function(){$q(".aero-menu-tip").remove()}).off("click.aeroTools").on("mouseenter.aeroTools",".aero-"+a.type+"s ul li",function(){Aero.view.admin.renderTools($q(this));return false}).off("click.aeroTools").on("mouseleave.aeroTools",".aero-"+a.type+"s ul li",function(){$q(".aero-item-tools").hide()}).off("change.aerob").on("change.aerob","select[name='aero_branch']",function(){$q('select[name="aero_return"]').parents("div:eq(0)").hide();if($q(this).val()!=""){$q('select[name="aero_return"]').parents("div:eq(0)").show()}})}};