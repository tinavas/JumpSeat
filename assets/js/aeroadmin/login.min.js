function login(){$q(".error").remove();clearBox();var a='<div class="alert-box error">Invalid username or password</div>';var b={username:$q('input[name="username"]').val().toLowerCase(),password:$q('input[name="password"]').val()};if(b.username==""){$q("form").prepend(a);return false}$q.post("/api/login",b,function(c){if(c.success){window.location="/apps"}else{$q("form").prepend(a)}})}function password_reset(){var b=$q('input[name="email"]').val();var d={email:b};var a='<div class="alert-box error">Email address not found.</div>';var e='<div class="alert-box success">Success! Please check your email for your reset password link.</div>';var f='<div class="alert-box info">Please wait while we find your account...</div>';var c=true;clearBox();if(b==""){$q("form").prepend(a);return false}$q("form").prepend(f);$q.get("/api/users/password_reset",d,function(g){$q(".info").remove();if(g.sent){$q(".email-form").hide();$q(".login").show();$q("form").prepend(e)}else{$q("form").prepend(a)}}).fail(function(){$q(".info").remove();$q("form").prepend(a)})}function getURLParameter(a){var d=window.location.search.substring(1);var c=d.split("&");for(var b=0;b<c.length;b++){var e=c[b].split("=");if(e[0]==a){return e[1]}}}function clearBox(){$q(".alert-box").hide()}$q("img").on("load",function(){$q(".jumbo").css("background-image",'url("/assets/images/jumbo-image.png")').fadeIn(500).animate({right:90},2000,"swing")}).each(function(){if(this.complete){$q(this).load()}});$q(function(){$q("[name=username]").focus();$q("body").on("keypress",function(b){var a=b.keyCode||b.which;if(a!="13"){return}login()});$q(".sign-in").on("click",function(a){login();return false});$q(".reset-password > a").on("click",function(a){clearBox();$q(".login").hide();$q(".email-form").show()});$q(".reset-pwd").on("click",function(a){password_reset();return false});$q("#reset").on("keydown",function(b){var a=b.keyCode||b.which;if(a!="13"){return}password_reset();return false});$q(".reset-cnl").on("click",function(a){clearBox();$q(".email-form").hide();$q(".login").show()});if(getURLParameter("error")){$q("form").prepend('<div class="alert-box error">Link is invalid or expired.</div>')}});